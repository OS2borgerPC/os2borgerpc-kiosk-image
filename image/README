In order to build the ISO image, use a Ubuntu 20.04 Server Edition
installation CD and basically follow the instructions on this page:

https://gist.github.com/s3rj1k/55b10cd20f31542046018fcce32f103e

For more info about autoinstall, see this page:

https://ubuntu.com/server/docs/install/autoinstall

Basically, go to the directory where you wish to build the ISO, get the
installation ISO and unpack it: ::

   wget http://releases.ubuntu.com/focal/ubuntu-20.04.1-live-server-amd64.iso

   # Extract ISO:
   mkdir iso
   7z x ubuntu-20.04.1-live-server-amd64.iso -oiso
   rm -rf 'iso/[BOOT]/'
   cp -r /path/to/image/ubuntu-image/* iso


Now you can make any modifications you want, e.g. to the install process in
``nocloud/user-data`` or to the boot instructions in ``isolinux`` or
``boot/grub``.

If you need to update the packages in the ISO please create a new
virtual machine from the ISO, log in to that machine and run:

apt clean
apt install --download-only <the packages you need>

Now take all the debs collected in /var/cache/apt/archives and copy to
"/pool/extras". Now proceed to build and sign the repositories in the
ISO by following the instructions in the ISO page.

This process (of signing and squashing etc) is described here:

https://help.ubuntu.com/community/InstallCDCustomization


Note: IF YOU ARE NOT UPDATING THE REPO IN pool/extras YOU DON'T NEED TO
SIGN THE REPOSITORIES OR CHANGE AND SIGN filesystem.squashfs.

Specifically, if you're only changing preseed or script files, all you
have to do is update the MD5 sum in the root.

If you *did* add debs to pool/extras, please note:

* To generate a new filesystem.squashfs, you must first unpack it with
  unsquashfs - the directory you get from that is where you put the
  updated keyrings.

* Delete the old filesystem.squashfs before rebuilding it with
  mksquashfs, otherwise your changes are written to new paths with "_1"
  appended.

* Do not worry about  dpkg-scanpackages, just follow the instructions
  for apt-ftparchive and you're good.
